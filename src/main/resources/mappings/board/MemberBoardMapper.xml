<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.learn.memberboard.impl.MemberBoardDAO">

	<insert id="insertBoard" parameterType="memberBoard">
		INSERT INTO CALL_CENTER
		 (QNA_NO,USER_ID,GRADE,QNA_TITLE,QNA_CONTENT,QNA_FILE)
		VALUES ((SELECT NVL(MAX(QNA_NO),0) + 1 FROM CALL_CENTER), #{userId},
		 #{grade}, #{qnaTitle}, #{qnaContent}, #{qnaFile})
	</insert>
		
<!-- 	<update id="updateBoard" parameterType="board"> -->
<!-- 		<if test="qboardNo != null"> -->
<!-- 		UPDATE QUESTION_BOARD -->
<!-- 		 SET BOARD_TITLE = #{boardTitle}, BOARD_CONTENT = #{boardContent}, BOARD_FILE = #{boardFile}, -->
<!-- 		  BOARD_ADOPT = #{boardAdopt}, BOARD_HIT = #{boardHit}, BOARD_LIKE = #{boardLike} -->
<!-- 		 WHERE QBOARD_NO = #{qboardNo} -->
<!-- 		</if> -->
		
<!-- 		<if test="qboardNo == null"> -->
<!-- 		UPDATE FREE_BOARD -->
<!-- 		 SET BOARD_TITLE = #{boardTitle}, BOARD_CONTENT = #{boardContent}, BOARD_FILE = #{boardFile}, -->
<!-- 		  BOARD_HIT = #{boardHit}, BOARD_LIKE = #{boardLike} -->
<!-- 		 WHERE FBOARD_NO = #{fboardNo} -->
<!-- 		</if>	 -->
<!-- 	</update> -->
	
<!-- 	<delete id="deleteBoard" parameterType="board"> -->
<!-- 		<if test="qboardNo != null"> -->
<!-- 			DELETE FROM QUESTION_BOARD WHERE QBOARD_NO = #{qboardNo}	 -->
<!-- 		</if> -->
		
<!-- 		<if test="qboardNo == null"> -->
<!-- 			DELETE FROM FREE_BOARD WHERE FBOARD_NO = #{fboardNo}			 -->
<!-- 		</if> -->
<!-- 	</delete> -->
	
<!-- 	<select id="getBoard" parameterType="board" resultType="board"> -->
<!-- 		<if test="qboardNo != null"> -->
<!-- 			SELECT * FROM QUESTION_BOARD WHERE QBOARD_NO = #{qboardNo} -->
<!-- 		</if> -->
		
<!-- 		<if test="qboardNo == null"> -->
<!-- 			SELECT * FROM FREE_BOARD WHERE FBOARD_NO = #{fboardNo} -->
<!-- 		</if>	 -->
<!-- 	</select> -->
	
	<select id="getBoardList" parameterType="memberBoard" resultType="memberBoard">
		SELECT * FROM CALL_CENTER
		WHERE 1 = 1
		AND USER_ID = #{userId}
		<if test="searchKeyword != null">
		OR QNA_TITLE LIKE '%'|| #{searchKeyword} ||'%'
		OR QNA_CONTENT LIKE '%'|| #{searchKeyword} ||'%'		
		</if>
				
		ORDER BY QNA_REGDATE DESC
	</select>
	
	<select id="resolvedCBoardList" parameterType="memberBoard" resultType="memberBoard">
		SELECT * FROM CALL_CENTER
		WHERE USER_ID = #{userId} AND QNA_ADOPT = 'TRUE'
		ORDER BY QNA_REGDATE DESC
	</select>
	
	<select id="unResolvedCBoardList" parameterType="memberBoard" resultType="memberBoard">
		SELECT * FROM CALL_CENTER
		WHERE USER_ID = #{userId} AND QNA_ADOPT = 'FALSE'
		ORDER BY QNA_REGDATE DESC
	</select>
	
	<select id="getBoard" parameterType="memberBoard" resultType="memberBoard">
		SELECT * FROM CALL_CENTER
		WHERE QNA_NO = #{qnaNo}
	</select>
	
</mapper>






